/* eslint-disable max-len */

import { useStore } from 'effector-react'
import { useState, useEffect } from 'react'
import { $mode } from '@/context/mode'
import styles from '@/styles/comments/index.module.scss'

interface Comment {
  name: string
  body: string
  time: number
}

const initialComments: Comment[] = [
  {
    name: 'Петр',
    body: 'Процесс покупки и доставки прошёл гладко. Спасибо!',
    time: 1741606496000,
  },
  {
    name: 'Pavel',
    body: 'Машина Mitsubishi была с небольшими повреждениями, но цена их компенсировала. В целом доволен.',
    time: 1737914678000,
  },
  {
    name: 'Андрей Москва',
    body: 'Заказал VW Golf из Германии через этот сайт — машина приехала в идеале! Пробег честный, состояние как у новой. Ребята помогли с документами, всё быстро и чётко. Спасибо за мечту на колёсах!',
    time: 1734222861000,
  },
  {
    name: 'John Smith',
    body: 'Долго мечтала о BMW X3, и вот она у меня! Пригнали из Европы за три недели, всё по договору, никаких сюрпризов. Салон чистый, технически без вопросов. Рекомендую всем!"',
    time: 1723147409000,
  },
  {
    name: 'Мария Иванова',
    body: 'Отличный сервис и оперативная поддержка, спасибо за качественную работу!',
    time: 1715763774000,
  },
  {
    name: 'Дмитрий, Москва',
    body: 'Привезли мне Audi A4 из Польши. Состояние — просто восторг! Даже не ожидал, что за такие деньги можно взять такую ухоженную машину. Отличный сервис, всегда были на связи.',
    time: 1708380140000,
  },
  {
    name: 'Сергей',
    body: 'Поцарапали бампер во время доставки автомобиля, но за ремонт заплатили.',
    time: 1689921053000,
  },
  {
    name: 'Екатерина',
    body: 'Очень доволен качеством предоставленных услуг, всё оформлено грамотно.',
    time: 1686229236000,
  },
  {
    name: 'Олег Петров',
    body: 'Спасибо за мой Mercedes C-класса! Пригон из Германии прошёл гладко, ребята подсказали, как выбрать, проверили авто перед покупкой. Теперь езжу и радуюсь каждый день!',
    time: 1682537419000,
  },
  {
    name: 'Наталья',
    body: 'Сайт полезен для выбора и покупки автомобиля, рекомендую всем!',
    time: 1678845601000,
  },
  {
    name: 'Дмитрий Александров',
    body: 'Оформление документов прошло быстро, сервис оставил приятное впечатление.',
    time: 1675153784000,
  },
  {
    name: 'Svetlana Petrova',
    body: 'Заказал Skoda Octavia — машина огонь! Пробег небольшой, всё обслужено, даже запах нового салона остался. Процесс прозрачный, цены адекватные. Буду обращаться ещё!',
    time: 1667770149000,
  },
  {
    name: 'Игорь',
    body: 'Очень полезная информация для тех, кто планирует покупку автомобиля за рубежом.',
    time: 1664078332000,
  },
  {
    name: 'Марина',
    body: 'Пригнали Peugeot 308 из Франции. Очень переживала, но зря — авто в отличном состоянии, документы в порядке. Команда работает на совесть, всем советую!',
    time: 1660386515000,
  },
  {
    name: 'Денис',
    body: 'Платформа удобна, быстро нашёл нужные сведения для покупки авто. Предоставили оперативную поддержку и качественную информацию.',
    time: 1656694697000,
  },
  {
    name: 'Сергей, Витебск',
    body: 'Мой новый Renault Megane — это любовь с первого взгляда! Привезли из Бельгии, всё как обещали: чистая история, никаких скрытых дефектов. Спасибо за профессионализм!',
    time: 1653002880000,
  },
  {
    name: 'Natalie',
    body: 'Volkswagen Tiguan из Германии — моя мечта сбылась! Машина в идеале, доставили быстро, помогли с растаможкой. Очень довольна, ребята знают своё дело!',
    time: 1649311063000,
  },
  {
    name: 'Виктория',
    body: 'Все документы оформлены правильно, а компания оставила приятное впечатление.',
    time: 1645619246000,
  },
  {
    name: 'Сергей Петров',
    body: 'Заказал Opel Astra — приехала как с картинки! Честный пробег, отличное состояние, ещё и дешевле, чем у нас на рынке. Сервис на высоте, рекомендую!',
    time: 1641927428000,
  },
  {
    name: 'Марина, Москва',
    body: 'Ford Focus из Литвы — просто находка! Пригнали за две недели, всё чётко, без лишних затрат. Теперь понимаю, почему все хвалят европейские машины.',
    time: 1638235611000,
  },
  {
    name: 'Владимир, Махачкала',
    body: 'Привезли Toyota Corolla из Нидерландов. Состояние — как будто вчера с завода! Ребята сопровождали на каждом этапе, никаких головняков. Отличная работа!',
    time: 1634543794000,
  },
  {
    name: 'Vlad44',
    body: 'Моя Mazda 3 из Польши — это восторг! Чистая, ухоженная, с полным пакетом документов. Спасибо за оперативность и честность!',
    time: 1630851976000,
  },
  {
    name: 'Юлия',
    body: 'Моя Mazda 3 из Польши — это восторг! Чистая, ухоженная, с полным пакетом документов. Спасибо за оперативность и честность!',
    time: 1627160159000,
  },
  {
    name: 'Ростов-на-Дону',
    body: 'Заказал Hyundai Tucson — пригнали из Германии в лучшем виде! Всё проверили перед покупкой, дали гарантию на состояние. Теперь езжу и кайфую!',
    time: 1623468342000,
  },
  {
    name: 'Наталья, Москва',
    body: 'Citroen C4 из Франции — просто прелесть! Машина в отличном состоянии, доставили быстро, помогли с оформлением. Спасибо за такой сервис!',
    time: 1619776524000,
  },
  {
    name: 'Роман',
    body: 'Привезли Seat Leon из Испании. Пробег небольшой, технически всё идеально. Ребята держали в курсе всего процесса, очень доволен!',
    time: 1616084707000,
  },
  {
    name: 'Анна',
    body: 'Моя мечта — Volvo XC60 — теперь у меня в гараже! Пригнали из Швеции, состояние как новое. Спасибо за профессионализм и внимание к деталям!',
    time: 1612392890000,
  },
  {
    name: 'Михаил',
    body: 'Заказал Kia Sportage из Германии. Машина превзошла ожидания: чистая, обслуженная, с честной историей. Сервис на уровне, буду рекомендовать!',
    time: 1608701072000,
  },
  {
    name: 'Елена',
    body: 'Привезли мне Honda Civic из Литвы. Всё прошло гладко, машина в отличном состоянии, даже мелочей не к чему придраться. Спасибо за вашу работу!',
    time: 1605009255000,
  },
  {
    name: 'Виктор',
    body: 'Мой новый Passat из Германии — это топ! Пригнали быстро, помогли с документами, цена приятно удивила. Отличный выбор для тех, кто хочет качество!',
    time: 1601317438000,
  },
  {
    name: 'Оксана',
    body: 'Заказала Renault Captur — машина супер! Из Франции, с небольшим пробегом, в идеальном состоянии. Ребята всё организовали наилучшим образом!',
    time: 1597625621000,
  },
  {
    name: 'Артём',
    body: 'Привезли BMW 5 серии из Германии. Качество на высоте, машина как новая! Процесс прозрачный, никаких скрытых платежей. Спасибо за честность!',
    time: 1593933803000,
  },
  {
    name: 'Светлана',
    body: 'Мой Audi Q5 из Австрии — это просто сказка! Пригнали быстро, состояние идеальное, даже сервисная книжка в порядке. Рекомендую всем!',
    time: 1590241986000,
  },
  {
    name: 'Николай',
    body: 'Заказал Volkswagen T-Roc — машина огонь! Из Германии, с минимальным пробегом, всё как обещали. Отличная команда, знают своё дело!',
    time: 1586550169000,
  },
  {
    name: 'Ирина',
    body: 'Моя Toyota RAV4 из Польши — лучшая покупка! Привезли в срок, состояние отличное, документы без проблем. Спасибо за такой подход!',
    time: 1582858351000,
  },
  {
    name: 'Станислав',
    body: 'Пригнали Škoda Kodiaq из Чехии. Машина в идеале, всё проверили перед покупкой, доставили без задержек. Очень доволен сервисом!',
    time: 1579166534000,
  },
  {
    name: 'Людмила',
    body: 'Мой Peugeot 5008 из Бельгии — просто восторг! Чистый, ухоженный, с полным комплектом документов. Спасибо за оперативность!',
    time: 1575474717000,
  },
  {
    name: 'Евгений Луганск',
    body: 'Заказал Hyundai i30 из Германии. Машина приехала в лучшем виде, всё как договаривались. Ребята помогли сэкономить, рекомендую!',
    time: 1571782899000,
  },
  {
    name: 'Дарья',
    body: 'Моя мечта — Mini Cooper — теперь со мной! Пригнали из Англии, состояние идеальное, даже запах салона новый. Спасибо за отличную работу!',
    time: 1568091082000,
  },
  {
    name: 'Олег Екатеринбург',
    body: 'Привезли Ford Mondeo из Германии. Машина в отличном состоянии, пробег честный, всё оформлено быстро. Отличный сервис, буду обращаться ещё!',
    time: 1564399265000,
  },
  {
    name: 'Валерия',
    body: 'Мой Nissan Qashqai из Литвы — это любовь! Пригнали за две недели, состояние как у нового авто. Спасибо за профессионализм и поддержку!',
    time: 1560707448000,
  },
]

const Comments = () => {
  const [comments, setComments] = useState<Comment[]>([])
  const [name, setName] = useState('')
  const [body, setBody] = useState('')

  useEffect(() => {
    const savedComments = localStorage.getItem('comments')
    if (savedComments) {
      setComments(JSON.parse(savedComments))
    } else {
      setComments(initialComments)
      localStorage.setItem('comments', JSON.stringify(initialComments))
    }
  }, [])

  const handleAddComment = () => {
    if (!name.trim() || !body.trim()) return

    const newComment: Comment = {
      name,
      body,
      time: Date.now(),
    }

    const updatedComments = [newComment, ...comments]
    setComments(updatedComments)
    localStorage.setItem('comments', JSON.stringify(updatedComments))

    setName('')
    setBody('')
  }

  const timeConverter = (timestamp: number) => {
    const date = new Date(timestamp)
    return date.toLocaleString()
  }

  const mode = useStore($mode)
  const darkModeClass = mode === 'dark' ? `${styles.dark_mode}` : ''

  return (
    <div className={`${styles.comments__block} ${darkModeClass}`}>
      <h2 className={`${styles.comments__block__title} ${darkModeClass}`}>
        Комментарии
      </h2>

      {/* Форма добавления комментариев */}
      <div className={`${styles.comments__block__inputs} ${darkModeClass}`}>
        <input
          type="text"
          placeholder="Ваше имя"
          value={name}
          onChange={(e) => setName(e.target.value)}
          className={`${styles.comments__block__inputs__input} ${darkModeClass}`}
        />
        <textarea
          placeholder="Ваш комментарий"
          value={body}
          onChange={(e) => setBody(e.target.value)}
          className={`${styles.comments__block__inputs__textarea} ${darkModeClass}`}
        />
        <button
          onClick={handleAddComment}
          className={`${styles.comments__block__inputs__button} ${darkModeClass}`}
        >
          Добавить комментарий
        </button>
      </div>

      {/* Список комментариев */}
      <div className={`${styles.comments__block__comments} ${darkModeClass}`}>
        {comments.length > 0 ? (
          comments.map((comment, index) => (
            <div
              key={index}
              className={`${styles.comments__block__comments__body} ${darkModeClass}`}
            >
              <p
                className={`${styles.comments__block__comments__body__name} ${darkModeClass}`}
              >
                {comment.name}
              </p>
              <p
                className={`${styles.comments__block__comments__body__comment} ${darkModeClass}`}
              >
                {comment.body}
              </p>
              <p
                className={`${styles.comments__block__comments__body__time} ${darkModeClass}`}
              >
                {timeConverter(comment.time)}
              </p>
            </div>
          ))
        ) : (
          <p className="text-gray-500">Комментариев пока нет.</p>
        )}
      </div>
    </div>
  )
}

export default Comments
